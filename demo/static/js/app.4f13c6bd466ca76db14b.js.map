{"version":3,"sources":["webpack:///./src/App.vue?a444","webpack:///./src/App.vue","webpack:///src/App.vue","webpack:///src/plugin/avatarCropper.vue","webpack:///./src/plugin/avatarCropper.vue?9b55","webpack:///./src/plugin/avatarCropper.vue","webpack:///./src/plugin/index.js","webpack:///./src/main.js"],"names":["selectortype_template_index_0_src_App","render","_vm","this","_h","$createElement","_c","_self","attrs","id","on","click","$event","show","_v","ok","data","model","value","callback","$$v","expression","staticStyle","display","src","staticRenderFns","src_App","__webpack_require__","normalizeComponent","name","ssrContext","avatarCropper","props","default","showRechoose","img","Image","canvasWidth","canvasHeight","scale","x","y","xLen","yLen","mouseDownX","mouseDownY","mouseIsDownCropper","mouseIsDownDot","methods","resizeCanvas","document","body","clientWidth","documentElement","getElementById","style","selectImg","changeImg","e","_this","target","files","size","reader","FileReader","readAsDataURL","onload","result","showImg","alert","_this2","widthIsLarger","width","height","ctx","getContext","clearRect","drawImage","showMask","mask","left","top","updateMouseDownPos","clientX","clientY","mousedownCropper","mousedownDot","mouseup","moveCropper","_cropper","cropperLen","Number","window","getComputedStyle","getPropertyValue","slice","cropperTop","cropperLeft","offsetX","offsetY","newTop","newLeft","resizeCropper","_cropper2","borderRadius","close","cropper","length","canvas","createElement","$emit","toDataURL","mounted","addEventListener","destroyed","removeEventListener","plugin_avatarCropper","directives","rawName","mouseleave","staticClass","_e","type","accept","change","position","overflow","mousemove","mousedown","src_plugin_avatarCropper","avatarCropper_normalizeComponent","VueAvatarCropper","install","Vue","component","use","el","h","App"],"mappings":"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","file":"static/js/app.4f13c6bd466ca76db14b.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('button',{on:{\"click\":function($event){_vm.show = true}}},[_vm._v(\"更换头像\")]),_vm._v(\" \"),_c('avatar-cropper',{on:{\"ok\":function($event){_vm.data = $event}},model:{value:(_vm.show),callback:function ($$v) {_vm.show=$$v},expression:\"show\"}}),_vm._v(\" \"),_c('img',{staticStyle:{\"display\":\"block\"},attrs:{\"src\":_vm.data}})],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-7ed12c06\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/App.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-7ed12c06\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../node_modules/vue-loader/lib/selector?type=styles&index=0!./App.vue\")\n}\nvar normalizeComponent = require(\"!../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\nimport __vue_script__ from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\n/* template */\nimport __vue_template__ from \"!!../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-7ed12c06\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../node_modules/vue-loader/lib/selector?type=template&index=0!./App.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/App.vue\n// module id = null\n// module chunks = ","<template>\n  <div id=\"app\">\n    <button @click=\"show = true\">更换头像</button>\n    <avatar-cropper v-model=\"show\" @ok=\"data = $event\"></avatar-cropper>\n    <img :src=\"data\" style=\"display: block\">\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'app',\n  data () {\n    return {\n      show: false,\n\n      data: ''\n    }\n  }\n}\n</script>\n\n<style>\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/App.vue","<template>\n  <!-- container ==> 半透明背景 -->\n  <!-- 鼠标在整个container中松开或离开container时停止拖动 -->\n  <div v-show=\"value\" id=\"container\" @mouseup=\"mouseup\" @mouseleave=\"mouseup\">\n    <!-- panel ==> 弹出的面板 -->\n    <div class=\"panel\">\n      <!-- 相关按钮 -->\n      <div class=\"buttons\">\n        <button class=\"button\" @click=\"close\">取消</button>\n        <button v-if=\"showRechoose\" class=\"button\" @click=\"selectImg\">重新选择</button>\n        <button class=\"button ok\" @click=\"ok\">确定</button>\n      </div>\n\n      <!-- 选择、显示、编辑面板 -->\n      <div class=\"select-panel\">\n        <div class=\"hint\">只支持JPG、PNG、GIF、SVG，大小不超过5M</div>\n        <button id=\"select\" class=\"button\" @click=\"selectImg\">选择图片</button>\n        <input id=\"inputFile\" type=\"file\" @change=\"changeImg\" style=\"display: none\" accept=\"image/gif,image/jpeg,image/jpg,image/png,image/svg\">\n\n        <!-- 编辑面板、背景接近黑色 -->\n        <div id=\"edit\">\n          <!-- canvas用来显示用户选择的图片 -->\n          <canvas id=\"pic\" :width=\"canvasWidth\" :height=\"canvasHeight\"></canvas>\n          <!-- 浅白色蒙版 -->\n          <div id=\"mask\" style=\"position: absolute; overflow: hidden\" @mousemove=\"resizeCropper\">\n            <!-- cropper ==> 选择框，圆形透明镂空 -->\n            <div id=\"cropper\" @mousedown=\"mousedownCropper\" @mousemove=\"moveCropper\">\n              <!-- dot ==> 用于改变大小 -->\n              <div id=\"dot\" @mousedown=\"mousedownDot\"></div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n\n  name: 'avatarCropper',\n\n  props: {\n    value: {\n      default: true\n    }\n  },\n\n  data () {\n    return {\n      // 是否显示重新选择\n      showRechoose: false,\n      // 存储用户选择的图片\n      img: new Image(),\n\n      // 图片画布的宽高\n      canvasWidth: 450,\n      canvasHeight: 450,\n\n      // 缩放比例， 显示/实际\n      scale: 1.0,\n\n      // 缩放后起点坐标和宽高\n      x: 0,\n      y: 0,\n      xLen: 0,\n      yLen: 0,\n\n      // 鼠标按下时的坐标\n      mouseDownX: 0,\n      mouseDownY: 0,\n\n      // 鼠标是否正在按下\n      // cropper内\n      mouseIsDownCropper: false,\n      // dot处\n      mouseIsDownDot: false,\n    }\n  },\n\n  methods: {\n    // 用于移动端适配， 设备宽度变化时调节画布宽高\n    resizeCanvas () {\n      if (document.body.clientWidth < 768) {\n        this.canvasWidth = this.canvasHeight = document.documentElement.clientWidth * 0.9\n\n        // 显示选择按钮，隐藏编辑面板\n        document.getElementById('select').style.display = 'inline-block'\n        document.getElementById('edit').style.display = 'none'\n      }\n    },\n\n    // 弹出选择文件窗口\n    selectImg () {\n      document.getElementById('inputFile').click()\n    },\n\n    // 当用户选择文件后调整显示的图片和蒙版\n    changeImg (e) {\n      const img = e.target.files[0]\n      // 限制图片不超过5M\n      if (img && img.size <= 5 * 1024 * 1024) {\n        // 隐藏选择按钮，显示编辑面板\n        document.getElementById('select').style.display = 'none'\n        document.getElementById('edit').style.display = 'block'\n        this.showRechoose = true\n\n        // 获取用户选择的图片数据\n        const reader = new FileReader()\n        reader.readAsDataURL(img)\n        reader.onload = () => {\n          // 修改显示的图片数据\n          this.img.src = reader.result\n          // 显示图片\n          this.showImg()\n        }\n      } else {\n        // 超过5M提醒\n        alert('图片不可以超过5M！')\n      }\n    },\n\n    // 显示图片\n    showImg () {\n      this.img.onload = () => {\n        // 缩放比以较长的那个边为准\n        const widthIsLarger = this.img.width >= this.img.height\n        this.scale = widthIsLarger ? this.canvasWidth / this.img.width : this.canvasHeight / this.img.height\n\n        // 计算显示图片的左上角坐标和缩放后宽高\n        this.xLen = this.img.width * this.scale\n        this.yLen = this.img.height * this.scale\n        this.x = (this.canvasWidth - this.xLen) / 2\n        this.y = (this.canvasHeight - this.yLen) / 2\n\n        // 显示缩放后的图片\n        const ctx = document.getElementById('pic').getContext('2d')\n        ctx.clearRect(0, 0, this.canvasWidth, this.canvasHeight)\n        ctx.drawImage(this.img, 0, 0, this.img.width, this.img.height, this.x, this.y, this.xLen, this.yLen)\n\n        // 显示蒙版\n        this.showMask()\n      }\n    },\n\n    // 显示蒙版\n    showMask () {\n      // 调整蒙版位置\n      const mask = document.getElementById('mask')\n      mask.style.left = this.x + 'px'\n      mask.style.top = this.y + 'px'\n      mask.style.width = this.xLen + 'px'\n      mask.style.height = this.yLen + 'px'\n    },\n\n    // 更新鼠标坐标\n    updateMouseDownPos (e) {\n      this.mouseDownX = e.clientX\n      this.mouseDownY = e.clientY\n    },\n\n    // 按下鼠标时记录鼠标坐标并更新mouseIsDown\n    mousedownCropper (e) {\n      if (this.mouseIsDownCropper) return\n      this.updateMouseDownPos(e)\n      this.mouseIsDownCropper = true\n    },\n    mousedownDot (e) {\n      if (this.mouseIsDownDot) return\n      this.updateMouseDownPos(e)\n      this.mouseIsDownDot = true\n    },\n\n    // 松开鼠标时更新mouseIsDown为false,结束拖动\n    mouseup () {\n      this.mouseIsDownCropper = this.mouseIsDownDot = false\n    },\n\n    // 移动cropper\n    moveCropper (e) {\n      if (this.mouseIsDownCropper) {\n        const cropper = document.getElementById('cropper')\n        const cropperLen = Number(window.getComputedStyle(cropper).getPropertyValue('width').slice(0, -2))\n        const cropperTop = Number(window.getComputedStyle(cropper).getPropertyValue('top').slice(0, -2))\n        const cropperLeft = Number(window.getComputedStyle(cropper).getPropertyValue('left').slice(0, -2))\n        const offsetX = e.clientX - this.mouseDownX\n        const offsetY = e.clientY - this.mouseDownY\n        this.updateMouseDownPos(e)\n        /* 当\n         * 0 <= top + len + offsetY <= yLen\n         * 0 <= left + len + offsetX <= xLen\n         * 时，移动cropper\n         */\n        const newTop = cropperTop + offsetY\n        const newLeft = cropperLeft + offsetX\n        if (newTop >= 0 && newTop + cropperLen <= this.yLen\n         && newLeft >= 0 && newLeft + cropperLen <= this.xLen) {\n          cropper.style.top = newTop + 'px'\n          cropper.style.left = newLeft + 'px'\n        }\n      }\n    },\n\n    // 修改cropper大小\n    resizeCropper (e) {\n      if (this.mouseIsDownDot) {\n        /*\n         * resize优先，因此在mouseIsDownDot为true时\n         * 设mouseIsDownCropper为false\n         */\n        this.mouseIsDownCropper = false\n        const cropper = document.getElementById('cropper')\n        const cropperLen = Number(window.getComputedStyle(cropper).getPropertyValue('width').slice(0, -2))\n        const cropperTop = Number(window.getComputedStyle(cropper).getPropertyValue('top').slice(0, -2))\n        const cropperLeft = Number(window.getComputedStyle(cropper).getPropertyValue('left').slice(0, -2))\n        const offsetX = e.clientX - this.mouseDownX\n        // const offsetY = e.clientY - this.mouseDownY\n        this.updateMouseDownPos(e)\n        /* 当\n         * len + offsetX >= 30\n         * top + len + offsetX <= yLen\n         * left + len + offsetX <= xLen\n         * 时，resize cropper\n         */\n        if (cropperLen + offsetX >= 30\n         && cropperTop + cropperLen + offsetX <= this.yLen\n         && cropperLeft + cropperLen + offsetX <= this.xLen) {\n          // 宽高均为len + offsetX\n          cropper.style.width = cropper.style.height = cropperLen + offsetX + 'px'\n          // border-radius为宽高的一半\n          cropper.style.borderRadius = (cropperLen + offsetX) / 2 + 'px'\n        }\n      }\n    },\n\n    // 用户选定后，传出选定的dataUrl\n    ok () {\n      if (!this.img.src) {\n        // 如果未选择图片\n        alert('请先选择图片！')\n        return\n      }\n      this.close()\n      const x = Number(window.getComputedStyle(cropper).getPropertyValue('left').slice(0, -2)) / this.scale\n      const y = Number(window.getComputedStyle(cropper).getPropertyValue('top').slice(0, -2)) / this.scale\n      const length = Number(window.getComputedStyle(cropper).getPropertyValue('width').slice(0, -2)) / this.scale\n      const canvas = document.createElement('canvas')\n      canvas.width = canvas.height = length\n      const ctx = canvas.getContext('2d')\n      ctx.drawImage(this.img, x, y, length, length, 0, 0, length, length)\n      this.$emit('ok', canvas.toDataURL())\n    },\n\n    // 关闭本插件\n    close () {\n      this.$emit('input', false)\n    }\n  },\n\n  mounted () {\n    this.resizeCanvas()\n    window.addEventListener('resize', this.resizeCanvas, false)\n  },\n\n  destroyed () {\n    window.removeEventListener('resize', this.resizeCanvas, false)\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n#container {\n  position: fixed;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  background-color: rgba(0, 0, 0, 0.3);\n  // 用户不可选\n  user-select: none;\n  z-index: 9999;\n}\n\n.panel {\n  position: fixed;\n  width: 100%;\n  height: 120vw;\n  top: calc(50vh - 60vw);\n  border-radius: 5px;\n  background-color: white;\n}\n\n.buttons {\n  width: 100%;\n  height: 56px;\n  margin-bottom: 20px;\n  background-color: #f2f2f5;\n  text-align: center;\n}\n\n.button {\n  margin: 11px 5px;\n  padding: 0 15px;\n  border: 0;\n  border-radius: 2px;\n  height: 34px;\n  line-height: 35px;\n  background-color: #fff;\n  color: #515a6e;\n  font-size: 14px;\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.25);\n  text-decoration: none;\n  outline: none;\n  cursor: pointer;\n}\n\n.ok {\n  background-color: #2d8cf0;\n  color: #fff;\n}\n\n.select-panel {\n  width: 90vw;\n  height: 90vw;\n  margin: 5vw;\n  background-color: #f2f2f5;\n}\n\n.hint {\n  position: absolute;\n  top: 60px;\n  width: 90vw;\n  text-align: center;\n  color: #515a6e;\n  font-size: 12px;\n}\n\n#select {\n  position: absolute;\n  left: calc(50vw - 43px);\n  top: calc(60vw - 17px);\n}\n\n#edit {\n  display: none;\n  position: absolute;\n  width: 90vw;\n  height: 90vw;\n  background-color: #333;\n}\n\n#cropper {\n  display: inline-block;\n  position: absolute;\n  top: 100px;\n  left: 100px;\n  width: 100px;\n  height: 100px;\n  border-radius: 50px;\n  box-shadow: 0 0 0 500px rgba(255, 255, 255, 0.6);\n  cursor: move;\n}\n\n#dot {\n  display: inline-block;\n  position: absolute;\n  top: 50%;\n  right: -4px;\n  border: 1px solid gray;\n  width: 7px;\n  height: 7px;\n  border-radius: 4px;\n  background-color: #fff;\n  cursor: w-resize;\n}\n\n@media screen and (min-width: 768px) {\n  .panel {\n    width: 500px;\n    height: 556px;\n    top: calc(50vh - 270px);\n    left: calc(50vw - 270px);\n  }\n\n  .select-panel {\n    width: 450px;\n    height: 450px;\n    margin: 25px;\n    background-color: #f2f2f5;\n  }\n\n  .hint {\n    width: 450px;\n  }\n\n  #select {\n    left: 207px;\n    top: 250px;\n  }\n\n  #edit {\n    width: 450px;\n    height: 450px;\n  }\n}\n</style>\n\n\n// WEBPACK FOOTER //\n// src/plugin/avatarCropper.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.value),expression:\"value\"}],attrs:{\"id\":\"container\"},on:{\"mouseup\":_vm.mouseup,\"mouseleave\":_vm.mouseup}},[_c('div',{staticClass:\"panel\"},[_c('div',{staticClass:\"buttons\"},[_c('button',{staticClass:\"button\",on:{\"click\":_vm.close}},[_vm._v(\"取消\")]),_vm._v(\" \"),(_vm.showRechoose)?_c('button',{staticClass:\"button\",on:{\"click\":_vm.selectImg}},[_vm._v(\"重新选择\")]):_vm._e(),_vm._v(\" \"),_c('button',{staticClass:\"button ok\",on:{\"click\":_vm.ok}},[_vm._v(\"确定\")])]),_vm._v(\" \"),_c('div',{staticClass:\"select-panel\"},[_c('div',{staticClass:\"hint\"},[_vm._v(\"只支持JPG、PNG、GIF、SVG，大小不超过5M\")]),_vm._v(\" \"),_c('button',{staticClass:\"button\",attrs:{\"id\":\"select\"},on:{\"click\":_vm.selectImg}},[_vm._v(\"选择图片\")]),_vm._v(\" \"),_c('input',{staticStyle:{\"display\":\"none\"},attrs:{\"id\":\"inputFile\",\"type\":\"file\",\"accept\":\"image/gif,image/jpeg,image/jpg,image/png,image/svg\"},on:{\"change\":_vm.changeImg}}),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"edit\"}},[_c('canvas',{attrs:{\"id\":\"pic\",\"width\":_vm.canvasWidth,\"height\":_vm.canvasHeight}}),_vm._v(\" \"),_c('div',{staticStyle:{\"position\":\"absolute\",\"overflow\":\"hidden\"},attrs:{\"id\":\"mask\"},on:{\"mousemove\":_vm.resizeCropper}},[_c('div',{attrs:{\"id\":\"cropper\"},on:{\"mousedown\":_vm.mousedownCropper,\"mousemove\":_vm.moveCropper}},[_c('div',{attrs:{\"id\":\"dot\"},on:{\"mousedown\":_vm.mousedownDot}})])])])])])])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-607be09b\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/plugin/avatarCropper.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-607be09b\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!less-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./avatarCropper.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./avatarCropper.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./avatarCropper.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-607be09b\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./avatarCropper.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-607be09b\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/plugin/avatarCropper.vue\n// module id = null\n// module chunks = ","'use strict'\n\nimport avatarCropper from './avatarCropper.vue'\n\nconst VueAvatarCropper = {\n  install (Vue) {\n    Vue.component('avatar-cropper', avatarCropper)\n  }\n}\n\nexport default VueAvatarCropper\n\n\n// WEBPACK FOOTER //\n// ./src/plugin/index.js","import Vue from 'vue'\nimport App from './App.vue'\n\nimport avatarCropper from './plugin/index.js'\nVue.use(avatarCropper)\n\nnew Vue({\n  el: '#app',\n  render: h => h(App)\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js"],"sourceRoot":""}
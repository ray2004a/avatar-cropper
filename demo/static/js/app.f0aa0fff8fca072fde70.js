webpackJsonp([1],{K5Eg:function(e,t){},NHnr:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=o("7+uW"),n={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"app"}},[o("button",{on:{click:function(t){e.show=!0}}},[e._v("更换头像")]),e._v(" "),o("avatar-cropper",{on:{ok:function(t){e.data=t}},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}}),e._v(" "),o("img",{staticStyle:{display:"block"},attrs:{src:e.data}})],1)},staticRenderFns:[]};var i=o("VU/8")({name:"app",data:function(){return{show:!1,data:""}}},n,!1,function(e){o("K5Eg")},null,null).exports,a={name:"avatarCropper",props:{value:{default:!0}},data:function(){return{showRechoose:!1,img:new Image,canvasWidth:450,canvasHeight:450,scale:1,x:0,y:0,xLen:0,yLen:0,mouseDownX:0,mouseDownY:0,mouseIsDownCropper:!1,mouseIsDownDot:!1}},methods:{resizeCanvas:function(){document.body.clientWidth<768&&(this.canvasWidth=this.canvasHeight=.9*document.documentElement.clientWidth,document.getElementById("select").style.display="inline-block",document.getElementById("edit").style.display="none")},selectImg:function(){document.getElementById("inputFile").click()},changeImg:function(e){var t=this,o=e.target.files[0];if(o&&o.size<=5242880){document.getElementById("select").style.display="none",document.getElementById("edit").style.display="block",this.showRechoose=!0;var s=new FileReader;s.readAsDataURL(o),s.onload=function(){t.img.src=s.result,t.showImg()}}else alert("图片不可以超过5M！")},showImg:function(){var e=this;this.img.onload=function(){var t=e.img.width>=e.img.height;e.scale=t?e.canvasWidth/e.img.width:e.canvasHeight/e.img.height,e.xLen=e.img.width*e.scale,e.yLen=e.img.height*e.scale,e.x=(e.canvasWidth-e.xLen)/2,e.y=(e.canvasHeight-e.yLen)/2;var o=document.getElementById("pic").getContext("2d");o.clearRect(0,0,e.canvasWidth,e.canvasHeight),o.drawImage(e.img,0,0,e.img.width,e.img.height,e.x,e.y,e.xLen,e.yLen),e.showMask()}},showMask:function(){var e=document.getElementById("mask");e.style.left=this.x+"px",e.style.top=this.y+"px",e.style.width=this.xLen+"px",e.style.height=this.yLen+"px"},updateMouseDownPos:function(e){this.mouseDownX=e.clientX,this.mouseDownY=e.clientY},mousedownCropper:function(e){this.mouseIsDownCropper||(this.updateMouseDownPos(e),this.mouseIsDownCropper=!0)},mousedownDot:function(e){this.mouseIsDownDot||(this.updateMouseDownPos(e),this.mouseIsDownDot=!0)},mouseup:function(){this.mouseIsDownCropper=this.mouseIsDownDot=!1},moveCropper:function(e){if(this.mouseIsDownCropper){var t=document.getElementById("cropper"),o=Number(window.getComputedStyle(t).getPropertyValue("width").slice(0,-2)),s=Number(window.getComputedStyle(t).getPropertyValue("top").slice(0,-2)),n=Number(window.getComputedStyle(t).getPropertyValue("left").slice(0,-2)),i=e.clientX-this.mouseDownX,a=e.clientY-this.mouseDownY;this.updateMouseDownPos(e);var r=s+a,c=n+i;r>=0&&r+o<=this.yLen&&c>=0&&c+o<=this.xLen&&(t.style.top=r+"px",t.style.left=c+"px")}},resizeCropper:function(e){if(this.mouseIsDownDot){this.mouseIsDownCropper=!1;var t=document.getElementById("cropper"),o=Number(window.getComputedStyle(t).getPropertyValue("width").slice(0,-2)),s=Number(window.getComputedStyle(t).getPropertyValue("top").slice(0,-2)),n=Number(window.getComputedStyle(t).getPropertyValue("left").slice(0,-2)),i=e.clientX-this.mouseDownX;this.updateMouseDownPos(e),o+i>=30&&s+o+i<=this.yLen&&n+o+i<=this.xLen&&(t.style.width=t.style.height=o+i+"px",t.style.borderRadius=(o+i)/2+"px")}},ok:function(){if(this.img.src){this.close();var e=Number(window.getComputedStyle(cropper).getPropertyValue("left").slice(0,-2))/this.scale,t=Number(window.getComputedStyle(cropper).getPropertyValue("top").slice(0,-2))/this.scale,o=Number(window.getComputedStyle(cropper).getPropertyValue("width").slice(0,-2))/this.scale,s=document.createElement("canvas");s.width=s.height=o,s.getContext("2d").drawImage(this.img,e,t,o,o,0,0,o,o),this.$emit("ok",s.toDataURL())}else alert("请先选择图片！")},close:function(){this.$emit("input",!1)}},mounted:function(){this.resizeCanvas(),window.addEventListener("resize",this.resizeCanvas,!1)},destroyed:function(){window.removeEventListener("resize",this.resizeCanvas,!1)}},r={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{directives:[{name:"show",rawName:"v-show",value:e.value,expression:"value"}],attrs:{id:"container"}},[o("div",{staticClass:"panel"},[o("div",{staticClass:"buttons"},[o("button",{staticClass:"button",on:{click:e.close}},[e._v("取消")]),e._v(" "),e.showRechoose?o("button",{staticClass:"button",on:{click:e.selectImg}},[e._v("重新选择")]):e._e(),e._v(" "),o("button",{staticClass:"button ok",on:{click:e.ok}},[e._v("确定")])]),e._v(" "),o("div",{staticClass:"select-panel"},[o("div",{staticClass:"hint"},[e._v("只支持JPG、PNG、GIF、SVG，大小不超过5M")]),e._v(" "),o("button",{staticClass:"button",attrs:{id:"select"},on:{click:e.selectImg}},[e._v("选择图片")]),e._v(" "),o("input",{staticStyle:{display:"none"},attrs:{id:"inputFile",type:"file",accept:"image/gif,image/jpeg,image/jpg,image/png,image/svg"},on:{change:e.changeImg}}),e._v(" "),o("div",{attrs:{id:"edit"},on:{mouseup:e.mouseup}},[o("canvas",{attrs:{id:"pic",width:e.canvasWidth,height:e.canvasHeight}}),e._v(" "),o("div",{staticStyle:{position:"absolute",overflow:"hidden"},attrs:{id:"mask"},on:{mousemove:e.resizeCropper}},[o("div",{attrs:{id:"cropper"},on:{mousedown:e.mousedownCropper,mousemove:e.moveCropper}},[o("div",{attrs:{id:"dot"},on:{mousedown:e.mousedownDot}})])])])])])])},staticRenderFns:[]};var c=o("VU/8")(a,r,!1,function(e){o("uAdM")},"data-v-3f3aa685",null).exports,u={install:function(e){e.component("avatar-cropper",c)}};s.a.use(u),new s.a({el:"#app",render:function(e){return e(i)}})},uAdM:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.f0aa0fff8fca072fde70.js.map